

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyaibox.misc package &mdash; pyaibox 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/katex-math.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js"></script>
        <script src="_static/katex_autorenderer.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pyaibox.nn package" href="pyaibox.nn.html" />
    <link rel="prev" title="pyaibox.evaluation package" href="pyaibox.evaluation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> pyaibox
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getstarted.html">Get Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pyaibox</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pyaibox.html">pyaibox package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pyaibox.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pyaibox.base.html">pyaibox.base package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyaibox.compression.html">pyaibox.compression package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyaibox.datasets.html">pyaibox.datasets package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyaibox.dsp.html">pyaibox.dsp package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyaibox.evaluation.html">pyaibox.evaluation package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">pyaibox.misc package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyaibox.nn.html">pyaibox.nn package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyaibox.summary.html">pyaibox.summary package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyaibox.utils.html">pyaibox.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pyaibox.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyaibox.html#module-pyaibox.version">pyaibox.version module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pyaibox.html#module-pyaibox">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="setup.html">setup module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyaibox</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">pyaibox</a> &raquo;</li>
        
          <li><a href="pyaibox.html">pyaibox package</a> &raquo;</li>
        
      <li>pyaibox.misc package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pyaibox.misc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="pyaibox-misc-package">
<h1>pyaibox.misc package<a class="headerlink" href="#pyaibox-misc-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-pyaibox.misc.bounding_box">
<span id="pyaibox-misc-bounding-box-module"></span><h2>pyaibox.misc.bounding_box module<a class="headerlink" href="#module-pyaibox.misc.bounding_box" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.bounding_box.fmt_bbox">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.bounding_box.</span></span><span class="sig-name descname"><span class="pre">fmt_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmtstr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LTRB2CHW'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.bounding_box.fmt_bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Formats bounding boxes</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The height and width are computed by <span class="math">\(y_{\rm max} - y_{\rm min}\)</span> and <span class="math">\(x_{\rm max} - x_{\rm min}\)</span>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bboxes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em> or </em><em>numpy array</em>) – The bounding boxes to be converted, all bboxes have the same mode.</p></li>
<li><p><strong>fmtstr</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'LTRB2TLBR'</span></code>: LeftTopRightBottom (xmin, ymin, xmax, ymax) –&gt; TopLeftBottomRight (ymin, xmin, ymax, xmax)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'TLBR2LTRB'</span></code>: TopLeftBottomRight (ymin, xmin, ymax, xmax) –&gt; LeftTopRightBottom (xmin, ymin, xmax, ymax)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CWH2CHW'</span></code>: CenterWidthHeight (x, y, w, h) –&gt; CenterHeightWidth (y, x, h, w)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CHW2CWH'</span></code>: CenterHeightWidth (y, x, h, w) –&gt; CenterWidthHeight (x, y, w, h)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'LTRB2CWH'</span></code>: LeftTopRightBottom (xmin, ymin, xmax, ymax) –&gt; CenterWidthHeight (x, y, w, h)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'LTRB2CHW'</span></code>: LeftTopRightBottom (xmin, ymin, xmax, ymax) –&gt; CenterHeightWidth (y, x, h, w)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'TLBR2CWH'</span></code>: TopLeftBottomRight (ymin, xmin, ymax, xmax) –&gt; CenterWidthHeight (x, y, w, h)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'TLBR2CHW'</span></code>: TopLeftBottomRight (ymin, xmin, ymax, xmax) –&gt; CenterHeightWidth (y, x, h, w)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CWH2LTRB'</span></code>: CenterWidthHeight (x, y, w, h) –&gt; LeftTopRightBottom (xmin, ymin, xmax, ymax)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CWH2TLBR'</span></code>: CenterWidthHeight (x, y, w, h) –&gt; TopLeftBottomRight (ymin, xmin, ymax, xmax)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CHW2LTRB'</span></code>: CenterHeightWidth (y, x, h, w) –&gt; LeftTopRightBottom (xmin, ymin, xmax, ymax)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CHW2TLBR'</span></code>: CenterHeightWidth (y, x, h, w) –&gt; TopLeftBottomRight (ymin, xmin, ymax, xmax)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'LRTB2LTRB'</span></code>: LeftRightTopBottom (xmin, xmax, ymin, ymax) –&gt; LeftTopRightBottom (xmin, ymin, xmax, ymax)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'LRTB2TLBR'</span></code>: LeftRightTopBottom (xmin, xmax, ymin, ymax) –&gt; TopLeftBottomRight (ymin, xmin, ymax, xmax)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'LTRB2LRTB'</span></code>: LeftTopRightBottom (xmin, ymin, xmax, ymax) –&gt; LeftRightTopBottom (xmin, xmax, ymin, ymax)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'LRTB2CWH'</span></code>: LeftRightTopBottom (xmin, xmax, ymin, ymax) –&gt; CenterWidthHeight (x, y, w, h)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'LRTB2CHW'</span></code>: LeftRightTopBottom (xmin, xmax, ymin, ymax) –&gt; CenterHeightWidth (y, x, h, w)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CWH2LRTB'</span></code>: CenterWidthHeight (x, y, w, h) –&gt; LeftRightTopBottom (xmin, xmax, ymin, ymax)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CHW2LRTB'</span></code>: CenterHeightWidth (y, x, h, w) –&gt; LeftRightTopBottom (xmin, xmax, ymin, ymax)</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list or numpy array</em> – The formated bounding boxes.</p></li>
<li><p>see <a class="reference internal" href="#pyaibox.misc.bounding_box.plot_bbox" title="pyaibox.misc.bounding_box.plot_bbox"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_bbox()</span></code></a></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.bounding_box.plot_bbox">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.bounding_box.</span></span><span class="sig-name descname"><span class="pre">plot_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">textpos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TopCenter'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.bounding_box.plot_bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots bounding boxes with scores and labels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bboxes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em> or </em><em>numpy array</em>) – The bounding boxes, in <code class="docutils literal notranslate"><span class="pre">LeftTopRightBottom</span></code> mode, which means (xmin, ymin, xmax, ymax)</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – The labels, can be a list of class id or class name. If None, won’t show labels.</p></li>
<li><p><strong>scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – The scores, can be a list of float numbers. If None, won’t show labels.</p></li>
<li><p><strong>edgecolors</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – The edgecolors for bounding boxes.</p></li>
<li><p><strong>linewidths</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The linewidths for bounding boxes.</p></li>
<li><p><strong>fontdict</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – The fontdict for labels and scores.</p></li>
<li><p><strong>textpos</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – The position for text (labels and scores).</p></li>
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – The offset for text (labels and scores).</p></li>
<li><p><strong>ax</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – The <code class="docutils literal notranslate"><span class="pre">ax</span></code> handle, If None, auto generated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>ax</em> – The <code class="docutils literal notranslate"><span class="pre">ax</span></code> handle</p></li>
<li><p>see <a class="reference internal" href="#pyaibox.misc.bounding_box.fmt_bbox" title="pyaibox.misc.bounding_box.fmt_bbox"><code class="xref py py-func docutils literal notranslate"><span class="pre">fmt_bbox()</span></code></a></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Plot bounding boxes with scores and labels on an image.</p>
<a class="reference internal image-reference" href="_images/demo_plot_bboxes.png"><img alt="_images/demo_plot_bboxes.png" class="align-center" src="_images/demo_plot_bboxes.png" style="width: 387.0px; height: 386.0px;" /></a>
<p>The results shown in the above figure can be obtained by the following codes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaibox</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">bboxes</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">]]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">]</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.987</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">edgecolors</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">pb</span><span class="o">.</span><span class="n">DISTINCT_COLORS_RGB_NORM</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">edgecolors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pb</span><span class="o">.</span><span class="n">DISTINCT_COLORS_RGB_NORM</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">linewidths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>

<span class="n">fontdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span>
            <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;italic&#39;</span><span class="p">,</span>
            <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;darkred&#39;</span><span class="p">,</span>
            <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
            <span class="p">}</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../../data/images/LenaRGB512.tif&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">pb</span><span class="o">.</span><span class="n">plot_bbox</span><span class="p">(</span><span class="n">bboxes</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">scores</span><span class="o">=</span><span class="n">scores</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="n">edgecolors</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="n">linewidths</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">,</span> <span class="n">textpos</span><span class="o">=</span><span class="s1">&#39;TopLeft&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;./bbbox.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pyaibox.misc.draw_shapes">
<span id="pyaibox-misc-draw-shapes-module"></span><h2>pyaibox.misc.draw_shapes module<a class="headerlink" href="#module-pyaibox.misc.draw_shapes" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.draw_shapes.draw_eclipse">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.draw_shapes.</span></span><span class="sig-name descname"><span class="pre">draw_eclipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centroids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aradii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bradii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[255,</span> <span class="pre">0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillcolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">2,</span> <span class="pre">-</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.draw_shapes.draw_eclipse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.draw_shapes.draw_rectangle">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.draw_shapes.</span></span><span class="sig-name descname"><span class="pre">draw_rectangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rects</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[[255,</span> <span class="pre">0,</span> <span class="pre">0]]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillcolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">3,</span> <span class="pre">-</span> <span class="pre">2)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.draw_shapes.draw_rectangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw rectangles in a tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy array</em>) – The input with any size.</p></li>
<li><p><strong>rects</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – The coordinates of the rectangles [[lefttop, rightbottom]].</p></li>
<li><p><strong>edgecolors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – The color of edge.</p></li>
<li><p><strong>linewidths</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The linewidths of edge.</p></li>
<li><p><strong>fillcolors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The color for filling.</p></li>
<li><p><strong>axes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The axes for drawing the rect (default [(-3, -2)]).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x</strong> (<em>numpy array</em>) – Output image array with rectangle shapes.</p></li>
<li><p>see <code class="xref py py-func docutils literal notranslate"><span class="pre">fmt_bbox()</span></code></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Draw rectangles in an figure, and return the result image array.</p>
<a class="reference internal image-reference" href="_images/demo_draw_rectangles.png"><img alt="_images/demo_draw_rectangles.png" class="align-center" src="_images/demo_draw_rectangles.png" style="width: 439.0px; height: 419.0px;" /></a>
<p>The results shown in the above figure can be obtained by the following codes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaibox</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pb</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../../data/images/LenaRGB512.tif&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># rects, edgecolors, fillcolors, linewidths = [[0, 0, 511, 511]], [None], [[0, 255, 0]], [1]</span>
<span class="c1"># rects, edgecolors, fillcolors, linewidths = [[0, 0, 511, 511]], [[255, 0, 0]], [None], [1]</span>
<span class="c1"># rects, edgecolors, fillcolors, linewidths = [[0, 0, 511, 511]], [[255, 0, 0]], [[0, 255, 0]], [1]</span>
<span class="n">rects</span><span class="p">,</span> <span class="n">edgecolors</span><span class="p">,</span> <span class="n">fillcolors</span><span class="p">,</span> <span class="n">linewidths</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">],</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">400</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">]],</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">draw_rectangle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rects</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="n">edgecolors</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="n">linewidths</span><span class="p">,</span> <span class="n">fillcolors</span><span class="o">=</span><span class="n">fillcolors</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>

<span class="n">pb</span><span class="o">.</span><span class="n">imsave</span><span class="p">(</span><span class="s1">&#39;out.png&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pyaibox.misc.mapping_operation">
<span id="pyaibox-misc-mapping-operation-module"></span><h2>pyaibox.misc.mapping_operation module<a class="headerlink" href="#module-pyaibox.misc.mapping_operation" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.mapping_operation.mapping">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.mapping_operation.</span></span><span class="sig-name descname"><span class="pre">mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">255.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'amplitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2Sigma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.mapping_operation.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>convert to image</p>
<p>Convert data to image data <span class="math">\(\bm X\)</span> with dynamic range <span class="math">\(d=[min, max]\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>numpy array</em>) – data to be converted</p></li>
<li><p><strong>drange</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><em>optional</em>) – dynamic range (the default is (0., 255.))</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – data mode in <code class="xref py py-attr docutils literal notranslate"><span class="pre">X</span></code>, <code class="docutils literal notranslate"><span class="pre">'amplitude'</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">'power'</span></code>.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – converting method, surpported values are <code class="docutils literal notranslate"><span class="pre">'1Sigma'</span></code>, <code class="docutils literal notranslate"><span class="pre">'2Sigma'</span></code>, <code class="docutils literal notranslate"><span class="pre">'3Sigma'</span></code>
(the default is ‘2Sigma’, which means two-sigma mapping)</p></li>
<li><p><strong>odtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>...</em><em>, </em><em>optional</em>) – output data type, supportted are <code class="docutils literal notranslate"><span class="pre">'auto'</span></code> (auto infer, default), or numpy.ndarray’s dtype string.
If the type of <code class="xref py py-attr docutils literal notranslate"><span class="pre">odtype</span></code> is not string, the output data type is <code class="docutils literal notranslate"><span class="pre">'th.float32'</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Y</strong> – converted image data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyaibox.misc.noising">
<span id="pyaibox-misc-noising-module"></span><h2>pyaibox.misc.noising module<a class="headerlink" href="#module-pyaibox.misc.noising" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.noising.awgn">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.noising.</span></span><span class="sig-name descname"><span class="pre">awgn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snrv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'db'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">power</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'measured'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.noising.awgn" title="Permalink to this definition">¶</a></dt>
<dd><p>AWGN Add white Gaussian noise to a signal.</p>
<p>AWGN Add white Gaussian noise to a signal like matlab.</p>
<p>Y = AWGN(X,snrv) adds white Gaussian noise to X.  The snrv is in dB.
The power of X is assumed to be 0 dBW.  If X is complex, then
AWGN adds complex noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sig</strong> (<em>tensor</em>) – Signal that will be noised.</p></li>
<li><p><strong>snrv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – Signal Noise Ratio (the default is 30)</p></li>
<li><p><strong>pmode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Power mode <code class="docutils literal notranslate"><span class="pre">'linear'</span></code>, <code class="docutils literal notranslate"><span class="pre">'db'</span></code> (the default is ‘db’)</p></li>
<li><p><strong>power</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – the power of signal or the method for computing power (the default is ‘measured’, which is sigPower = np.sum(np.abs(sig) ** 2) / np.numel(sig))</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Seed for random number generator. (the default is None, which means different each time)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>noised data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tensor</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IOError" title="(in Python v3.10)"><strong>IOError</strong></a> – No input signal</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – Input signal shape wrong</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.noising.awgns">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.noising.</span></span><span class="sig-name descname"><span class="pre">awgns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snrv</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.noising.awgns" title="Permalink to this definition">¶</a></dt>
<dd><p>adds white gaussian noise to signal</p>
<p>see <a class="reference external" href="https://sites.ualberta.ca/~msacchi/SNR_Def.pdf">Adding noise with a desired signal-to-noise ratio</a> .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>tensor</em>) – The pure signal data.</p></li>
<li><p><strong>snrv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – The signal-to-noise ratio value in dB.</p></li>
<li><p><strong>caxis</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – If <code class="xref py py-attr docutils literal notranslate"><span class="pre">x</span></code> is complex-valued but represented in real format,
<code class="xref py py-attr docutils literal notranslate"><span class="pre">caxis</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">cdim</span></code> should be specified. If not, it’s set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>,
which means <code class="xref py py-attr docutils literal notranslate"><span class="pre">x</span></code> is real-valued or complex-valued in complex format.</p></li>
<li><p><strong>keepcaxis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – keep the complex dimension?</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – Specifies the dimensions for adding noise, if not specified, it’s set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>,
which means all the dimensions.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – Specifies the seed for generating random noise, if not specified, it’s set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, noise will also be returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>y</strong> (<em>tensor</em>) – The SNRs.</p></li>
<li><p>see <a class="reference internal" href="#pyaibox.misc.noising.awgns2" title="pyaibox.misc.noising.awgns2"><code class="xref py py-func docutils literal notranslate"><span class="pre">awgns2()</span></code></a>.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span> <span class="k">as</span> <span class="nn">th</span>
<span class="kn">import</span> <span class="nn">torchbox</span> <span class="k">as</span> <span class="nn">pb</span>

<span class="n">pb</span><span class="o">.</span><span class="n">setseed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">r2c</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># 5, 3, 4</span>
<span class="n">y</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">awgns</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2022</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">snrv</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">snr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">snrv</span><span class="p">,</span> <span class="s1">&#39;complex-valued in complex-format&#39;</span><span class="p">)</span>

<span class="n">pb</span><span class="o">.</span><span class="n">setseed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">y</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">awgns</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepcaxis</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2022</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">snrv</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">snr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepcaxis</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">snrv</span><span class="p">,</span> <span class="s1">&#39;complex-valued in real-format&#39;</span><span class="p">)</span>

<span class="n">pb</span><span class="o">.</span><span class="n">setseed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">y</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">awgns</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2022</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">snrv</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">snr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">snrv</span><span class="p">,</span> <span class="s1">&#39;real-valued in real-format&#39;</span><span class="p">)</span>

<span class="n">pb</span><span class="o">.</span><span class="n">setseed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">y</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">awgns2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2022</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">snrv</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">snr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">keepcaxis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">snrv</span><span class="p">,</span> <span class="s1">&#39;real-valued in real-format, multi-channel&#39;</span><span class="p">)</span>

<span class="c1"># ---output</span>
<span class="p">[</span><span class="mf">29.97444457</span> <span class="mf">30.06965181</span> <span class="mf">29.95413251</span> <span class="mf">29.99284633</span> <span class="mf">29.96209985</span><span class="p">]</span> <span class="nb">complex</span><span class="o">-</span><span class="n">valued</span> <span class="ow">in</span> <span class="nb">complex</span><span class="o">-</span><span class="nb">format</span>
<span class="p">[</span><span class="mf">29.97444457</span> <span class="mf">30.06965181</span> <span class="mf">29.95413251</span> <span class="mf">29.99284633</span> <span class="mf">29.96209985</span><span class="p">]</span> <span class="nb">complex</span><span class="o">-</span><span class="n">valued</span> <span class="ow">in</span> <span class="n">real</span><span class="o">-</span><span class="nb">format</span>
<span class="p">[</span><span class="mf">29.99399902</span> <span class="mf">30.04417082</span> <span class="mf">30.05313719</span> <span class="mf">29.86315167</span> <span class="mf">29.9423689</span> <span class="p">]</span> <span class="n">real</span><span class="o">-</span><span class="n">valued</span> <span class="ow">in</span> <span class="n">real</span><span class="o">-</span><span class="nb">format</span>
<span class="p">[</span><span class="mf">29.97424739</span> <span class="mf">30.07329346</span> <span class="mf">29.95404992</span> <span class="mf">29.98695481</span> <span class="mf">29.94601035</span><span class="p">]</span> <span class="n">real</span><span class="o">-</span><span class="n">valued</span> <span class="ow">in</span> <span class="n">real</span><span class="o">-</span><span class="nb">format</span><span class="p">,</span> <span class="n">multi</span><span class="o">-</span><span class="n">channel</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.noising.awgns2">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.noising.</span></span><span class="sig-name descname"><span class="pre">awgns2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snrv</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.noising.awgns2" title="Permalink to this definition">¶</a></dt>
<dd><p>adds white gaussian noise to multi-channel signal</p>
<p>see <a class="reference external" href="https://sites.ualberta.ca/~msacchi/SNR_Def.pdf">Adding noise with a desired signal-to-noise ratio</a> .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>tensor</em>) – The pure real-valued multi-channel signal data.</p></li>
<li><p><strong>snrv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – The signal-to-noise ratio value in dB.</p></li>
<li><p><strong>caxis</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Specifies the channel dimension. If not specified, <code class="xref py py-attr docutils literal notranslate"><span class="pre">x</span></code> will be treated as
single-channel signal.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – Specifies the dimensions for adding noise, if not specified, it’s set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>,
which means all the dimensions.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – Specifies the seed for generating random noise, if not specified, it’s set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, noise will also be returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>y</strong> (<em>tensor</em>) – The SNRs.</p></li>
<li><p>see <a class="reference internal" href="#pyaibox.misc.noising.awgns" title="pyaibox.misc.noising.awgns"><code class="xref py py-func docutils literal notranslate"><span class="pre">awgns()</span></code></a>.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<a class="reference internal image-reference" href="_images/DemoNoiseAWGNS.png"><img alt="_images/DemoNoiseAWGNS.png" class="align-center" src="_images/DemoNoiseAWGNS.png" style="width: 557.0px; height: 561.0px;" /></a>
<p>The results shown in the above figure can be obtained by the following codes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">datafolder</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">data_path</span><span class="p">(</span><span class="s1">&#39;optical&#39;</span><span class="p">)</span>
<span class="n">xr</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">datafolder</span> <span class="o">+</span> <span class="s1">&#39;Einstein256.png&#39;</span><span class="p">)</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">datafolder</span> <span class="o">+</span> <span class="s1">&#39;LenaGRAY256.png&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">xr</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">xi</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">c2r</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">xnp15</span><span class="p">,</span> <span class="n">np15</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">awgns2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">snrv</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">xn0</span><span class="p">,</span> <span class="n">n0</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">awgns2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">snrv</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">xnn5</span><span class="p">,</span> <span class="n">nn5</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">awgns2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">snrv</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pb</span><span class="o">.</span><span class="n">snr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np15</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pb</span><span class="o">.</span><span class="n">snr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n0</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pb</span><span class="o">.</span><span class="n">snr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">nn5</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xnp15</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xnp15</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xn0</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xn0</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xnn5</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xnn5</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imshow</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">xnp15</span><span class="p">,</span> <span class="n">xn0</span><span class="p">,</span> <span class="n">xnn5</span><span class="p">],</span> <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">,</span> <span class="s1">&#39;noised(15dB)&#39;</span><span class="p">,</span> <span class="s1">&#39;noised(0dB)&#39;</span><span class="p">,</span> <span class="s1">&#39;noised(-5dB)&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.noising.imnoise">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.noising.</span></span><span class="sig-name descname"><span class="pre">imnoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'awgn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snrv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'chnllast'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.noising.imnoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Add noise to image</p>
<p>Add noise to each channel of the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>tensor</em>) – image aray</p></li>
<li><p><strong>noise</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – noise type (the default is ‘awgn’, which means white gaussian noise, using <a class="reference internal" href="#pyaibox.misc.noising.awgn" title="pyaibox.misc.noising.awgn"><code class="xref py py-func docutils literal notranslate"><span class="pre">awgn()</span></code></a>)</p></li>
<li><p><strong>snrv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – Signal-to-noise ratio (the default is 30, which [default_description])</p></li>
<li><p><strong>peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – Peak value in input, if None, auto detected (default), if <code class="docutils literal notranslate"><span class="pre">'maxv'</span></code>, use the maximum value as peak value.</p></li>
<li><p><strong>fmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – for color image, <code class="xref py py-attr docutils literal notranslate"><span class="pre">fmt</span></code> should be specified with <code class="docutils literal notranslate"><span class="pre">'chnllast'</span></code> or <code class="docutils literal notranslate"><span class="pre">'chnlfirst'</span></code>, for gray image, <code class="xref py py-attr docutils literal notranslate"><span class="pre">fmt</span></code> should be setted to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Images with added noise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<a class="reference internal image-reference" href="_images/DemoIMNOISE.png"><img alt="_images/DemoIMNOISE.png" class="align-center" src="_images/DemoIMNOISE.png" style="width: 518.0px; height: 523.0px;" /></a>
<p>The results shown in the above figure can be obtained by the following codes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">datafolder</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">data_path</span><span class="p">(</span><span class="s1">&#39;optical&#39;</span><span class="p">)</span>
<span class="n">xr</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">datafolder</span> <span class="o">+</span> <span class="s1">&#39;Einstein256.png&#39;</span><span class="p">)</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">datafolder</span> <span class="o">+</span> <span class="s1">&#39;LenaGRAY256.png&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">xr</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">xi</span>

<span class="n">xnp15</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imnoise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;awgn&#39;</span><span class="p">,</span> <span class="n">snrv</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">xn0</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imnoise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;awgn&#39;</span><span class="p">,</span> <span class="n">snrv</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">xnn5</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imnoise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;awgn&#39;</span><span class="p">,</span> <span class="n">snrv</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">xnp15</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xnp15</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">xn0</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xn0</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">xnn5</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xnn5</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">plt</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imshow</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">xnp15</span><span class="p">,</span> <span class="n">xn0</span><span class="p">,</span> <span class="n">xnn5</span><span class="p">],</span> <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">,</span> <span class="s1">&#39;noised(15dB)&#39;</span><span class="p">,</span> <span class="s1">&#39;noised(0dB)&#39;</span><span class="p">,</span> <span class="s1">&#39;noised(-5dB)&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">datafolder</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">data_path</span><span class="p">(</span><span class="s1">&#39;optical&#39;</span><span class="p">)</span>
<span class="n">xr</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">datafolder</span> <span class="o">+</span> <span class="s1">&#39;Einstein256.png&#39;</span><span class="p">)</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">datafolder</span> <span class="o">+</span> <span class="s1">&#39;LenaGRAY256.png&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">xr</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">xi</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">c2r</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="n">xnp15</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imnoise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;awgn&#39;</span><span class="p">,</span> <span class="n">snrv</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">xn0</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imnoise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;awgn&#39;</span><span class="p">,</span> <span class="n">snrv</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">xnn5</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imnoise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;awgn&#39;</span><span class="p">,</span> <span class="n">snrv</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xnp15</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xnp15</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xn0</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xn0</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">xnn5</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xnn5</span><span class="p">,</span> <span class="n">caxis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imshow</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">xnp15</span><span class="p">,</span> <span class="n">xn0</span><span class="p">,</span> <span class="n">xnn5</span><span class="p">],</span> <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">,</span> <span class="s1">&#39;noised(15dB)&#39;</span><span class="p">,</span> <span class="s1">&#39;noised(0dB)&#39;</span><span class="p">,</span> <span class="s1">&#39;noised(-5dB)&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.noising.wgn">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.noising.</span></span><span class="sig-name descname"><span class="pre">wgn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">power</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dbw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'real'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.noising.wgn" title="Permalink to this definition">¶</a></dt>
<dd><p>WGN Generates white Gaussian noise.</p>
<p>WGN Generates white Gaussian noise like matlab.</p>
<p>Y = WGN((M,N),P) generates an M-by-N matrix of white Gaussian noise. P
specifies the power of the output noise in dBW. The unit of measure for
the output of the wgn function is Volts. For power calculations, it is
assumed that there is a load of 1 Ohm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a>) – Shape of noising matrix</p></li>
<li><p><strong>power</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – P specifies the power of the output noise in dBW.</p></li>
<li><p><strong>pmode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Power mode of the output noise (the default is ‘dbw’)</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – data type, real or complex (the default is ‘real’, which means real-valued)</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Seed for random number generator. (the default is None, which means different each time)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Matrix of white Gaussian noise (real or complex).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyaibox.misc.sampling">
<span id="pyaibox-misc-sampling-module"></span><h2>pyaibox.misc.sampling module<a class="headerlink" href="#module-pyaibox.misc.sampling" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.sampling.dnsampling">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.sampling.</span></span><span class="sig-name descname"><span class="pre">dnsampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'discard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.sampling.dnsampling" title="Permalink to this definition">¶</a></dt>
<dd><p>down-sampling a tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – The input tensor.</p></li>
<li><p><strong>ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – Downsampling ratio.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Downsampling axis (default -1).</p></li>
<li><p><strong>smode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Downsampling mode: <code class="docutils literal notranslate"><span class="pre">'uniform'</span></code>, <code class="docutils literal notranslate"><span class="pre">'random'</span></code>, <code class="docutils literal notranslate"><span class="pre">'random2'</span></code>.</p></li>
<li><p><strong>omode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – output mode: <code class="docutils literal notranslate"><span class="pre">'discard'</span></code> for discarding, <code class="docutils literal notranslate"><span class="pre">'zero'</span></code> for zero filling.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – seed for numpy’s random.</p></li>
<li><p><strong>extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, also return sampling mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Description</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(ndarray)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">axis</span></code></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">ratio</span></code>, attr:<cite>smode</cite>, attr:<cite>omode</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.sampling.patch2tensor">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.sampling.</span></span><span class="sig-name descname"><span class="pre">patch2tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(256,</span> <span class="pre">256)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nfirst'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.sampling.patch2tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>merge patch to a tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>tensor</em>) – A tensor of patches.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><em>optional</em>) – Merged tensor size in the dimension (the default is (256, 256)).</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><em>optional</em>) – Merged axis of patch (the default is (1, 2))</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Patch mode <code class="docutils literal notranslate"><span class="pre">'nfirst'</span></code> or <code class="docutils literal notranslate"><span class="pre">'nlast'</span></code> (the default is ‘nfirst’,
which means the first dimension is the number of patches)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Merged tensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p>see <a class="reference internal" href="#pyaibox.misc.sampling.tensor2patch" title="pyaibox.misc.sampling.tensor2patch"><code class="xref py py-func docutils literal notranslate"><span class="pre">tensor2patch()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.sampling.read_samples">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.sampling.</span></span><span class="sig-name descname"><span class="pre">read_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datafiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[['SI',</span> <span class="pre">'ca',</span> <span class="pre">'cr']]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sequentially'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.sampling.read_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Read samples</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datafiles</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of path strings</p></li>
<li><p><strong>keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – data keys to be read</p></li>
<li><p><strong>nsamples</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – number of samples for each data file</p></li>
<li><p><strong>groups</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – number of groups in each data file</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – sampling mode for all datafiles</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – sampling axis for all datafiles</p></li>
<li><p><strong>parts</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – number of parts (split samples into some parts)</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – the seed for random stream</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>samples</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tensor</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">nsamples</span></code> should be large enough</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.sampling.sample_tensor">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.sampling.</span></span><span class="sig-name descname"><span class="pre">sample_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sequentially'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.sampling.sample_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>sample a tensor</p>
<p>Sample a tensor sequentially/uniformly/randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – a numpy or torch tensor to be sampled</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – sample number</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – the axis to be sampled (the default is 0)</p></li>
<li><p><strong>groups</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – number of groups in this tensor (the default is 1)</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'sequentially'</span></code>: evenly spaced (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'uniformly'</span></code>: [0, int(n/groups)]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'randomly'</span></code>: randomly selected, non-returned sampling</p></li>
</ul>
</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – only work for <code class="docutils literal notranslate"><span class="pre">'randomly'</span></code> mode (the default is None)</p></li>
<li><p><strong>extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, also return the selected indexes, the default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sampled numpy or torch tensor.
idx (list): Sampled indexes, if <code class="xref py py-attr docutils literal notranslate"><span class="pre">extra</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, this will also be returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>y (ndarray)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setseed</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">y1</span><span class="p">,</span> <span class="n">idx1</span> <span class="o">=</span> <span class="n">sample_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;sequentially&#39;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y2</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">sample_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;uniformly&#39;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y3</span><span class="p">,</span> <span class="n">idx3</span> <span class="o">=</span> <span class="n">sample_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;randomly&#39;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y3</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">idx1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">idx2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">idx3</span><span class="p">)</span>

<span class="n">the</span> <span class="n">outputs</span> <span class="n">are</span> <span class="k">as</span> <span class="n">follows</span><span class="p">:</span>

<span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – The tensor does not has enough samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.sampling.shuffle_tensor">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.sampling.</span></span><span class="sig-name descname"><span class="pre">shuffle_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inter'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.sampling.shuffle_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>shuffle a tensor</p>
<p>Shuffle a tensor randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – A numpy or torch tensor to be shuffled.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The axis to be shuffled (default 0)</p></li>
<li><p><strong>groups</strong> (<em>number</em><em>, </em><em>optional</em>) – The number of groups in this tensor (default 1)</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'inter'</span></code>: between groups (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'intra'</span></code>: within group</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'whole'</span></code>: the whole</p></li>
</ul>
</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em> or </em><em>number</em><em>, </em><em>optional</em>) – random seed (the default is None)</p></li>
<li><p><strong>extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, also returns the shuffle indexes, the default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Shuffled numpy or torch tensor.
idx (list): Shuffled indexes, if <code class="xref py py-attr docutils literal notranslate"><span class="pre">extra</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, this will also be returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>y (ndarray)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Shuffle a tensor randomly with different modes (<code class="docutils literal notranslate"><span class="pre">'intra'</span></code>, <code class="docutils literal notranslate"><span class="pre">'inter'</span></code>, <code class="docutils literal notranslate"><span class="pre">'whole'</span></code>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setseed</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">y1</span><span class="p">,</span> <span class="n">idx1</span> <span class="o">=</span> <span class="n">shuffle_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;intra&#39;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y2</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">shuffle_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;inter&#39;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y3</span><span class="p">,</span> <span class="n">idx3</span> <span class="o">=</span> <span class="n">shuffle_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;whole&#39;</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y3</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">idx1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">idx2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">idx3</span><span class="p">)</span>

<span class="n">the</span> <span class="n">outputs</span> <span class="n">are</span> <span class="k">as</span> <span class="n">follows</span><span class="p">:</span>

<span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">19</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.sampling.slidegrid">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.sampling.</span></span><span class="sig-name descname"><span class="pre">slidegrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shake</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.sampling.slidegrid" title="Permalink to this definition">¶</a></dt>
<dd><p>generates sliding grid indexes</p>
<p>Generates <code class="xref py py-attr docutils literal notranslate"><span class="pre">n</span></code> sliding grid indexes from <code class="xref py py-attr docutils literal notranslate"><span class="pre">start</span></code> to <code class="xref py py-attr docutils literal notranslate"><span class="pre">stop</span></code>
with step size <code class="xref py py-attr docutils literal notranslate"><span class="pre">step</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – start sampling point</p></li>
<li><p><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – stop sampling point</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – sampling stepsize</p></li>
<li><p><strong>shake</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – the shake rate, if <code class="xref py py-attr docutils literal notranslate"><span class="pre">shake</span></code> is 0, no shake, (default),
if positive, add a positive shake, if negative, add a negative.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a>) – the number of samples (default None, int((stop0 - start0) / step0) * int((stop1 - start1) / step1)…).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>for multi-dimension, return a 2-d tensor, for 1-dimension, return a 1d-tensor.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><strong>TypeError</strong></a> – The number of samples should be an integer or None.</p>
</dd>
</dl>
<p>see <code class="xref py py-func docutils literal notranslate"><span class="pre">randperm()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">randgrid()</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.sampling.split_tensor">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.sampling.</span></span><span class="sig-name descname"><span class="pre">split_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.7,</span> <span class="pre">0.2,</span> <span class="pre">0.1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.sampling.split_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>split a tensor</p>
<p>split a tensor into some parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – A numpy array or torch tensor.</p></li>
<li><p><strong>ratios</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – Split ratios (the default is [0.7, 0.2, 0.05])</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Split axis (the default is 0)</p></li>
<li><p><strong>shuffle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether shuffle (the default is False)</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Shuffule seed (the default is None)</p></li>
<li><p><strong>extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, also return the split indexes, the default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Splitted ndarrays.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(list of ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.sampling.tensor2patch">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.sampling.</span></span><span class="sig-name descname"><span class="pre">tensor2patch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(256,</span> <span class="pre">256)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shake</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'slidegrid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.sampling.tensor2patch" title="Permalink to this definition">¶</a></dt>
<dd><p>sample patch from a tensor</p>
<p>Sample some patches from a tensor, tensor and patch can be any size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – A tensor to be sampled.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The number of pactches, the default is None, auto computed,
equals to the number of blocks with specified <code class="xref py py-attr docutils literal notranslate"><span class="pre">step</span></code></p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The size of patch (the default is (256, 256))</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – The sampling axis (the default is (0, 1))</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Start sampling index for each axis (the default is (0, 0))</p></li>
<li><p><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Stopp sampling index for each axis. (the default is (None, None), which [default_description])</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Sampling stepsize for each axis  (the default is (1, 1), which [default_description])</p></li>
<li><p><strong>shake</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em>, </em><em>optional</em>) – float for shake rate, int for shake points (the default is (0, 0), which means no shake)</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Sampling mode, <code class="docutils literal notranslate"><span class="pre">'slidegrid'</span></code>, <code class="docutils literal notranslate"><span class="pre">'randgrid'</span></code>, <code class="docutils literal notranslate"><span class="pre">'randperm'</span></code> (the default is ‘slidegrid’)</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Random seed. (the default is None, which means no seed.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tensor of sampled patches.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(ndarray)</p>
</dd>
</dl>
<p>see <a class="reference internal" href="#pyaibox.misc.sampling.patch2tensor" title="pyaibox.misc.sampling.patch2tensor"><code class="xref py py-func docutils literal notranslate"><span class="pre">patch2tensor()</span></code></a>.</p>
<p class="rubric">Example</p>
<p>Sample patches from a tensor with different mode (randperm, randgrid, slidegrid),
and then reform these patches into an image.</p>
<a class="reference internal image-reference" href="_images/demo_sample_patch.png"><img alt="_images/demo_sample_patch.png" class="align-center" src="_images/demo_sample_patch.png" style="width: 727.0px; height: 700.0px;" /></a>
<p>The results shown in the above figure can be obtained by the following codes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyaibox</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;../../data/images/Lotus512.png&#39;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;../../data/images/LenaRGB512.tif&#39;</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">xshape</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
<span class="n">xshape</span> <span class="o">=</span> <span class="n">xshape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

<span class="n">n</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">tensor2patch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">shake</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;randperm&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">tensor2patch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="n">shake</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;randgrid&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">y3</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">tensor2patch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="n">shake</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;slidegrid&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">y4</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">tensor2patch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="n">shake</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;slidegrid&#39;</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">y1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y2</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y3</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y4</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">Y1</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">patch2tensor</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">xshape</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nfirst&#39;</span><span class="p">)</span>
<span class="n">Y2</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">patch2tensor</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">xshape</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nfirst&#39;</span><span class="p">)</span>
<span class="n">Y3</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">patch2tensor</span><span class="p">(</span><span class="n">y3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">xshape</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nfirst&#39;</span><span class="p">)</span>
<span class="n">Y4</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">patch2tensor</span><span class="p">(</span><span class="n">y4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">xshape</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nfirst&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Y1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;randperm, shake=(0, 0)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Y2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;randgrid, shake=(0, 0)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Y3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;slidegrid, shake=(0, 0)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Y4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;slidegrid, shake=(32, 32)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pyaibox.misc.transform">
<span id="pyaibox-misc-transform-module"></span><h2>pyaibox.misc.transform module<a class="headerlink" href="#module-pyaibox.misc.transform" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.transform.ct2rt">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.transform.</span></span><span class="sig-name descname"><span class="pre">ct2rt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.transform.ct2rt" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a complex-valued tensor to a real-valued tensor</p>
<p>Converts a complex-valued tensor <span class="math">\({\bf x}\)</span> to a real-valued tensor with FFT and conjugate symmetry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The input tensor <span class="math">\({\bf x}\)</span>.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The axis for excuting FFT.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Tensor</em> – The output tensor <span class="math">\({\bf y}\)</span>.</p></li>
<li><p>see also <a class="reference internal" href="#pyaibox.misc.transform.rt2ct" title="pyaibox.misc.transform.rt2ct"><code class="xref py py-func docutils literal notranslate"><span class="pre">rt2ct()</span></code></a>.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<a class="reference internal image-reference" href="_images/CT2RTRT2CTdemo.png"><img alt="_images/CT2RTRT2CTdemo.png" class="align-center" src="_images/CT2RTRT2CTdemo.png" style="width: 507.0px; height: 805.0px;" /></a>
<p>The results shown in the above figure can be obtained by the following codes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyaibox</span> <span class="k">as</span> <span class="nn">pb</span>

<span class="n">datafolder</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">data_path</span><span class="p">(</span><span class="s1">&#39;optical&#39;</span><span class="p">)</span>
<span class="n">xr</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">datafolder</span> <span class="o">+</span> <span class="s1">&#39;Einstein256.png&#39;</span><span class="p">)</span>
<span class="n">xi</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">datafolder</span> <span class="o">+</span> <span class="s1">&#39;LenaGRAY256.png&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">xr</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">xi</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">ct2rt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">rt2ct</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>


<span class="n">plt</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">imshow</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">imag</span><span class="p">],</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;original(real)&#39;</span><span class="p">,</span> <span class="s1">&#39;original(imag)&#39;</span><span class="p">,</span> <span class="s1">&#39;converted(real)&#39;</span><span class="p">,</span>
                <span class="s1">&#39;converted(imag)&#39;</span><span class="p">,</span> <span class="s1">&#39;reconstructed(real)&#39;</span><span class="p">,</span> <span class="s1">&#39;reconstructed(imag)&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.transform.db20">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.transform.</span></span><span class="sig-name descname"><span class="pre">db20</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.transform.db20" title="Permalink to this definition">¶</a></dt>
<dd><p>compute dB</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><em>array</em>) – linear value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the dB value of x.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a> or array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.transform.quantization">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.transform.</span></span><span class="sig-name descname"><span class="pre">quantization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">31]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.transform.quantization" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantize data.</p>
<div class="math">
\[{\bm X} \in [a, b] \rightarrow y \in [c, d]

\]</div>
<div class="math">
\[{\bm Y} = \lfloor (d-c) (X-a) / (b-a) + c \rfloor.

\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – The data to be quantized with shape <span class="math">\({\bm X} \in {\mathbb R}^{N_a×N_r}\)</span>, or <span class="math">\({\bm X} \in {\mathbb C}^{N_a×N_r}\)</span>.</p></li>
<li><p><strong>idrange</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – Specifies the range of data. Default <span class="math">\([{\rm min}(X), {\rm max}(X)]\)</span>.</p></li>
<li><p><strong>odrange</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – Specifies the range of data after beening quantized. Default [0, 31].</p></li>
<li><p><strong>odtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – output data type, supportted are <code class="docutils literal notranslate"><span class="pre">'auto'</span></code> (auto infer, default), or numpy ndarray’s dtype string.
If the type of <code class="xref py py-attr docutils literal notranslate"><span class="pre">odtype</span></code> is not string(such as None), the type of output data is the same with input.</p></li>
<li><p><strong>extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, also return <code class="xref py py-attr docutils literal notranslate"><span class="pre">idrange</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">odrange</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Quantized data ndarray, if the input is complex, will return a ndarray with shape <span class="math">\({\bm Y} \in {\mathbb R}^{N_a×N_r×2}\)</span>.
idrange, odrange (list or tuple): If <code class="xref py py-attr docutils literal notranslate"><span class="pre">extra</span></code> is true, also be returned</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(ndarray)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.10)"><strong>Exception</strong></a> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">idrange</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">odrange</span></code> should be (tulpe) or (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.transform.rt2ct">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.transform.</span></span><span class="sig-name descname"><span class="pre">rt2ct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.transform.rt2ct" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a real-valued tensor to a complex-valued tensor</p>
<p>Converts a real-valued tensor <span class="math">\({\bf y}\)</span> to a complex-valued tensor with FFT and conjugate symmetry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Tensor</em>) – The input tensor <span class="math">\({\bf y}\)</span>.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – The axis for excuting FFT.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Tensor</em> – The output tensor <span class="math">\({\bf x}\)</span>.</p></li>
<li><p>see also <a class="reference internal" href="#pyaibox.misc.transform.ct2rt" title="pyaibox.misc.transform.ct2rt"><code class="xref py py-func docutils literal notranslate"><span class="pre">ct2rt()</span></code></a>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.transform.scale">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.transform.</span></span><span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">st</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">istrunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.transform.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale data.</p>
<div class="math">
\[x \in [a, b] \rightarrow y \in [c, d]

\]</div>
<div class="math">
\[y = (d-c)*(x-a) / (b-a) + c.

\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – The data to be scaled.</p></li>
<li><p><strong>st</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – Specifies the range of data after beening scaled. Default [0, 1].</p></li>
<li><p><strong>sf</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – Specifies the range of data. Default [min(X), max(X)].</p></li>
<li><p><strong>istrunc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Specifies wether to truncate the data to [a, b], For example,
If sf == [a, b] and ‘istrunc’ is true,
then X[X &lt; a] == a and X[X &gt; b] == b.</p></li>
<li><p><strong>extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, also return <code class="xref py py-attr docutils literal notranslate"><span class="pre">st</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">sf</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scaled data ndarray.
st, sf (list or tuple): If <code class="xref py py-attr docutils literal notranslate"><span class="pre">extra</span></code> is true, also be returned</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>out (ndarray)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.10)"><strong>Exception</strong></a> – Description</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyaibox.misc.transform.standardization">
<span class="sig-prename descclassname"><span class="pre">pyaibox.misc.transform.</span></span><span class="sig-name descname"><span class="pre">standardization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyaibox.misc.transform.standardization" title="Permalink to this definition">¶</a></dt>
<dd><div class="math">
\[\bar{X} = \frac{X-\mu}{\sigma}

\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – data to be normalized,</p></li>
<li><p><strong>mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – mean value (the default is None, which means auto computed)</p></li>
<li><p><strong>std</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><em>None</em></a><em>, </em><em>optional</em>) – standard deviation (the default is None, which means auto computed)</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – specify the axis for computing mean and standard deviation (the default is None, which means all elements)</p></li>
<li><p><strong>extra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – if True, also return the mean and std (the default is False, which means just return the standardized data)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Standardized/Normalized ndarray.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(ndarray)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyaibox.misc">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyaibox.misc" title="Permalink to this headline">¶</a></h2>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pyaibox.nn.html" class="btn btn-neutral float-right" title="pyaibox.nn package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pyaibox.evaluation.html" class="btn btn-neutral float-left" title="pyaibox.evaluation package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018-2020, Zhi Liu

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>